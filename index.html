<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css" />

    <!--link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen"-->
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <!--link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print"-->
    
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>ServletIO by zerh</title>
  </head>

  <body>
    <a class="github-fork-ribbon" href="https://github.com/zerh/Servlet-IO" title="Fork me on GitHub">Fork me on GitHub</a>
    <div id="container">
      <div class="inner">

        <header>
          <h1>ServletIO</h1>
          <h2>Convert your servlets to MVC controllers</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="servletio-2.0.jar" id="download-jar" class="button"><span>Download .jar</span></a>
          <a href="https://github.com/zerh/Servlet-IO/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <!--a href="https://github.com/zerh/Servlet-IO/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a-->
          <!--a href="https://github.com/zerh/Servlet-IO" id="view-on-github" class="button"><span>View on GitHub</span></a-->
        </section>

        <hr>
<p><em>Supported since Servlet</em> <strong>3.0.1</strong> <em>or higher, and Java</em> <strong>6</strong> <em>or higher</em></p>
<hr>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>Add <strong>"/*"</strong> to your mapped url, example: <code>@WebServlet("/your-path/*")</code>, and replace the super class <code>HttpServlet</code> by <code>ServletIO</code>.</p>

<h3>
<a id="http-routing" class="anchor" href="#http-routing" aria-hidden="true"><span class="octicon octicon-link"></span></a>HTTP Routing</h3>

<p>The path reference to a method is the method name, but also could be a specified path in the annotation params of <code>@Get</code>, <code>@Post</code>, <code>@Put</code>, <code>@Delete</code> or <code>@Options</code>:</p>




<pre><code class="java">

import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get("/mypath/")
    public Result methodName(Request req){
        return respond("Hello World").asHtml();
    }
    
    @Get
    public Result mypath2(Request req){
        return respond("Hello World").asHtml();
    }
}
  
</code></pre>

<p>
What you'll get:
<ul>
  <li>http://host:port/base-path/mypath</li>
  <li>http://host:port/base-path/mypath2</li>
</ul>
</p>

<p>If you want to map the base path to a method, just use <strong>"/"</strong> as path in the method annotation (<code>@Get</code>, <code>@Post</code>, <code>@Put</code>, <code>@Delete</code> or <code>@Options</code>) </p>

<p>The parameters could be mapped as pretty url using <strong>":"</strong> before the url parameter as below:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get("/edit/:id")
    public Result edit(Request req){
        return respond("The url has: " + req.param(":id") + "").as("text/html");
    }
}
</code></pre>
<hr>

<h3>
<a id="servlet-style-methods" class="anchor" href="#servlet-style-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Servlet Style Methods</h3>

<p>A Servlet style method is a Java method that receive a <code>servletio.Request</code> and a <code>servletio.Response</code> parameters as below:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public void hello(Request req, Response res){
        res.printHtml("&#060;h1&#062;hellow world&#060;/h1&#062;");
    }
}
</code></pre>

<p>You can either use <code>Request</code> or <code>Response</code> only as method parameters. This classes wrap HttpServletRequest and HttpServletResponse and offer some facilities. The most prominents are:</p>

<h5>
<a id="request" class="anchor" href="#request" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request</h5>

<ul>
<li>
<code>request.bindParam(MyBean.class)</code> returns an instance of <code>MyBean</code> with all values of HTML form, by mapping bean property names.</li>
<li>
<code>request.getFile(String paramName)</code> returns a File with the uploaded file reference.</li>
<li>
<code>request.dispatcher(String dispatcherName)</code> returns an instance of <code>servletio.Dispatcher</code>, wrap of <code>RequestDispatcher</code>.</li>
<li>
<code>request.raw</code> final propierty with <code>HttpServletRequest</code> object reference of the current request.</li>
</ul>

<h5>
<a id="response" class="anchor" href="#response" aria-hidden="true"><span class="octicon octicon-link"></span></a>Response</h5>

<ul>
<li>
<code>response.print(String htmlString, String contentType)</code>.</li>
<li>
<code>response.print(String text)</code> print text plain.</li>
<li>
<code>response.printHtml(String htmlString)</code> print text with HTML content type.</li>
<li>
<code>response.printXml(String xmlString)</code> print text with XML content type.</li>
<li>
<code>response.printJson(String xmlString)</code> print text with JSON content type.</li>
<li>
<code>response.redirect(String location)</code> redirect to the specified location.</li>
<li>
<code>response.redirect(String location, int httpStatusCode)</code> redirect to the specified location with status code.</li>
<li>
<code>response.sendError(int error)</code> send custom error code to the browser.</li>
<li>
<code>response.sendBadRequest()</code> sen 400 error code to the browser.</li>
<li>
<code>response.sendInternalServerError()</code> send 500 error code to the browser.</li>
<li>
<code>response.raw</code> final propierty with <code>HttpServletResponse</code> object reference of the current request</li>
</ul>

<hr>

<h3>
<a id="result-methods" class="anchor" href="#result-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Result Object</h3>

<p>Returning a <code>Result</code> object, is just an elegant way to declare controllers methods. The <code>Result</code> object wraps with <code>ServletIO</code> the methods printers of the <code>Response</code> object, to produce standard HTTP results. </p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result hello(Request req){
        return respond("content");
    }
}
</code></pre>

<p>The object Result has methods <code>asHtml()</code>, <code>asJson()</code>, <code>as(String contentType)</code>, <code>withCookies(Cookies... cookies)</code>, <code>withDiscardingCookies(Cookies... cookies)</code> and others helpers methods that returns the same instance of the <code>Result</code> object like the next example:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result hello(Request req){
        return respond("&#060;h1&#062;content&#060;/h1&#062;").asHtml();
    }
}
</code></pre>
<p>ServletIO contains some helper in addition to <code>respond(String content)</code> method, that return objects Result:</p>

<ul>
<li>
<code>internalServerError(String content)</code> returns HTTP results with the 500 code.</li>
<li>
<code>sendFile(InputStream inputStream)</code> send file to client.</li>
<li>
<code>badRequest(String optionalContent)</code>returns HTTP results with the 400 code.</li>
<li>
<code>notFound(String optionalContent)</code> returns HTTP results with the 404 code.</li>
<li>
<code>redirect(String target)</code> redirect to the target.</li>
<li>
<code>temporaryRedirect(String target)</code> redirect to the target with 303 code</li>
</ul>

<hr>

<h3>
<a id="before-and-after" class="anchor" href="#before-and-after" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/Before" class="user-mention">@Before</a> and <a href="https://github.com/After" class="user-mention">@After</a>
</h3>

<p>Methods annotated with the <code>@Before</code> annotation are executed before each action call for <code>ServletIO</code>, and methods annotated with the <code>@After</code> annotation are executed after each action call for the Servlet:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result index(Request req){
        return respond("&#060;h1&#062;hello world&#060;/h1&#062;").as("text/html");
    }

    @Before
    public void validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)
            res.printHtml("bye bye!!");
    }

    @After
    public void log(Request req, Response res){
        System.out.println("Action executed...");
    }

    @After
    public Result onNotFound(Request req){
        if(!isMapped(req))
            return notFound("&#060;h1&#062;404, not found&#060;/h1&#062;").as("text/html");

        return null;
    }

}
</code></pre>
<p>If you don’t want the <code>@Before</code> or <code>@After</code> methods to intercept all request, you can specify a list of actions using <code>only</code> param:</p>
<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result login(Request req){
        return respond("&#060;h1&#062;login&#060;/h1&#062;").as("text/html");
    }

    @Before(only="/admin")
    public void validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)  
            res.redirect("login");
    }

    @After(only={"/login", "/logout"})
    public void log(Request req, Response res){
        System.out.prinln("/login or /logout executed")
    }

    ...
}
</code></pre>

<p>Or you can specify a list of actions to exclude for <code>@After</code> or <code>@Before</code> using the <code>unless</code> param:</p>


<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Before(unless="/login")
    public void validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)
            req.dispatcher("login").forward(req, res);
    }
    ...
}
</code></pre>

<p>You can set execution priority of <code>@Before</code> or <code>@After</code> methods using <code>priority</code> param, example <code>@Before(priority=1)</code>, by default priority is 0 (executed first):</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Before(only="/admin/something", priority=2)
    public void adminSomething(Request req, Response res){
        //some filter for this action
    }

    @Before(only="/admin/*", priority=1)
    public void validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)
            res.redirect("login");
    }
    ...
}
</code></pre>

<hr>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
        </section>

        <footer>
          ServletIO is maintained by <a href="https://github.com/zerh">zerh</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
