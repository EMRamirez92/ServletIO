<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css" />

    <!--link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen"-->
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <!--link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print"-->
    
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>ServletIO by zerh</title>
    <style>
      .github-fork-ribbon:before {
        background-color: #000 !important;
      }
    </style>
  </head>

  <body>
    <a class="github-fork-ribbon" href="https://github.com/zerh/Servlet-IO" title="Fork me on GitHub">Fork me on GitHub</a>
    <div id="container">
      <div class="inner">

        <header>
          
            
          <h1>Servlet IO</h1>
          <h2>Convert your servlets to MVC controllers</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="servletio-2.1.jar" id="download-jar" class="button"><span>Download .jar</span></a>
          <a href="https://github.com/zerh/Servlet-IO/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <!--a href="https://github.com/zerh/Servlet-IO/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a-->
          <!--a href="https://github.com/zerh/Servlet-IO" id="view-on-github" class="button"><span>View on GitHub</span></a-->
        </section>

        <hr>
<p><em>Supported since Servlet</em> <strong>3.0.1</strong> <em>or higher, and Java</em> <strong>6</strong> <em>or higher</em></p>
<hr>

<h3><a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h3>

<p>Add <strong>"/*"</strong> to your mapped url, and replace the super class <code>HttpServlet</code> by <code>ServletIO</code>:</p>


<pre><code class="java" style="height:140px">
@WebServlet("/base-path/*")
public class MyApp extends ServletIO {
    
    ...
    
}
</code></pre>

<hr/>

<h3>
<a id="http-routing" class="anchor" href="#http-routing" aria-hidden="true"><span class="octicon octicon-link"></span></a>HTTP Routing</h3>

<p>The path reference to a method is the method name, but also could be a specified path in the annotation params of <code class="java">@Get</code>, <code class="java">@Post</code>, <code class="java">@Put</code>, <code class="java">@Delete</code> or <code class="java">@Options</code>:</p>


<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get("/mypath/")
    public Result methodName(){
        return respond("Hello World").asHtml();
    }
    
    @Get
    public Result mypath2(){
        return respond("Hello World").asHtml();
    }
}
  
</code></pre>

<p>
What you'll get:
<ul>
  <li>http://host:port/base-path/mypath</li>
  <li>http://host:port/base-path/mypath2</li>
</ul>
</p>

<p>If you want to map the base path to a method, just use <strong>"/"</strong> as path in the method annotation (<code class="java">@Get</code>, <code class="java">@Post</code>, <code class="java">@Put</code>, <code class="java">@Delete</code> or <code class="java">@Options</code>) </p>

<p>The parameters could be mapped as pretty url using <strong>":"</strong> before the url parameter as below:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get("/read/:id")
    public Result edit(Request req){
        return respond("The url has: " + req.param(":id")).as("text/html");
    }
}
</code></pre>

<p>Also you may map the request parameters or path parameters (using <strong>":"</strong> before) with @Param annotation as below:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get("/edit/:id")
    public Result edit(@Param(":id") int id){
        return respond("The url has: " + id ).asHtml();
    }
}
</code></pre>

<p>The <code class="java">Result</code> object in this methods is just an elegant way to declare controllers methods. The <code class="java">Result</code> object wraps with <code class="java">ServletIO</code> the methods printers of the <code class="java">Response</code> object, to produce standard HTTP results. </p>

<p>The object Result has methods <code class="java">asHtml()</code>, <code class="java">asJson()</code>, <code class="java">as(String contentType)</code>, <code class="java">withCookies(Cookies... cookies)</code>, <code class="java">withDiscardingCookies(Cookies... cookies)</code> and others helpers methods that returns the same instance of the <code class="java">Result</code></p>

<p>ServletIO contains some helper in addition to <code class="java">respond(String content)</code> method, that return objects Result:</p>

<ul>
<li>
<code class="java">internalServerError(String content)</code> returns HTTP results with the 500 code.</li>
<li>
<code class="java">sendFile(InputStream inputStream)</code> send file to client.</li>
<li>
<code class="java">badRequest(String optionalContent)</code>returns HTTP results with the 400 code.</li>
<li>
<code class="java">notFound(String optionalContent)</code> returns HTTP results with the 404 code.</li>
<li>
<code class="java">redirect(String target)</code> redirect to the target.</li>
<li>
<code class="java">temporaryRedirect(String target)</code> redirect to the target with 303 code</li>
</ul>

<hr>


<h3>
  <a id="JspView" class="anchor" href="#JspView" aria-hidden="true"><span class="octicon octicon-link"></span></a>JspView
</h3>
<p>
  JspView class manages jsp views and models. The default folder for all jsp views is <strong>/WEB-INF/views</strong>. You may use JspView as below:
</p>
<pre><code class="java">
import javax.servlet.annotation.WebServlet;

java.util.HashMap;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {
    
    @Get("/myview")
    public JspView myView(){ 
        //is not necesary the ".jsp" in the viewName
        return new JspView("viewName", "myList", Arrays.asList("a","b","c"));
    }
    
    @Get("/myview2")
    public JspView myView(){ 
        Map<String, Object> modelMap = new HashMap<String, Object>();
        modelMap.put("myList", Arrays.asList("d","e","f"))
        return new JspView("viewName", modelMap);
    }
    
}    
</code></pre>

<p>
    The file <strong>/WEB-INF/views/viewName.jsp</strong>, could by something like this:
</p>

<pre><code class="html">
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
        &lt;title&gt;Insert title here&lt;/title&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;c:forEach items=&quot;${myList}&quot; var=&quot;item&quot;&gt;
            ${item}&lt;br&gt;
        &lt;/c:forEach&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>



<hr />

<h3>
<a id="servlet-style-methods" class="anchor" href="#servlet-style-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request and Response</h3>

<p>You may receive a <code class="java">servletio.Request</code> and a <code class="java">servletio.Response</code> parameters as below:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result hello(Request req, Response res){
        res.printHtml("&#060;h1&#062;hellow world&#060;/h1&#062;");
        
        return null;
    }
}
</code></pre>

<p>Also, you can use another mapped method as dispatcher:</p>

<pre><code>
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {
    
    @Get
    public Result admin(Request req, Response res){
        if(req.session().attribute("user")==null){
            //call method login as dispatcher
            req.dispatcher("login").forward(req, res);
        }
        
        return null;
    }

    @Get
    public Result login(Request req, Response res){
        req.dispatcher("/WEB-INF/login.jsp").forward(req, res);
        
        return null;
    }
}
</code></pre>

<p>You can either use <code class="java">Request</code> or <code class="java">Response</code> only as method parameters. This classes wrap HttpServletRequest and HttpServletResponse and offer some facilities. The most prominents are:</p>

<h5>
<a id="request" class="anchor" href="#request" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request</h5>

<ul>
<li>
<code class="java">request.bindParam(MyBean.class)</code> returns an instance of <code class="java">MyBean</code> with all values of HTML form, by mapping bean property names.</li>
<li>
<code class="java">request.getFile(String paramName)</code> returns a File with the uploaded file reference.</li>
<li>
<code class="java">request.dispatcher(String dispatcherName)</code> returns an instance of <code class="java">servletio.Dispatcher</code>, wrap of <code class="java">RequestDispatcher</code>.</li>
<li>
<code class="java">request.raw</code> final propierty with <code class="java">HttpServletRequest</code> object reference of the current request.</li>
</ul>

<h5>
<a id="response" class="anchor" href="#response" aria-hidden="true"><span class="octicon octicon-link"></span></a>Response</h5>

<ul>
<li>
<code class="java">response.print(String htmlString, String contentType)</code>.</li>
<li>
<code class="java">response.print(String text)</code> print text plain.</li>
<li>
<code class="java">response.printHtml(String htmlString)</code> print text with HTML content type.</li>
<li>
<code class="java">response.printXml(String xmlString)</code> print text with XML content type.</li>
<li>
<code class="java">response.printJson(String xmlString)</code> print text with JSON content type.</li>
<li>
<code class="java">response.redirect(String location)</code> redirect to the specified location.</li>
<li>
<code class="java">response.redirect(String location, int httpStatusCode)</code> redirect to the specified location with status code.</li>
<li>
<code class="java">response.sendError(int error)</code> send custom error code to the browser.</li>
<li>
<code class="java">response.sendBadRequest()</code> sen 400 error code to the browser.</li>
<li>
<code class="java">response.sendInternalServerError()</code> send 500 error code to the browser.</li>
<li>
<code class="java">response.raw</code> final propierty with <code class="java">HttpServletResponse</code> object reference of the current request</li>
</ul>


<hr />
<h3>
<a id="render" class="anchor" href="#render" aria-hidden="true"><span class="octicon octicon-link"></span></a>Render Interface
</h3>
<p>If you want to create your own views, you only need to implement the interface Render. The Result and JspView classes implements the Render interface.</p>
<p>A Render interface implementation just need override the method <strong>void render(Request request, Response response)</strong> as below:</p>

<pre><code class="java">

import servletio.*;
import com.google.gson.Gson;

public class JsonView implements Render{
    
    private Object obj;
    
    public JsonView(Object obj){
        this.obj = obj;
    }

    void render(Request request, Response response){
        //print text with JSON content type
        response.printJson(new Gson.toJson(this.obj));
    }
}
</code></pre>

<p>You could use this class in your ServletIO controllers just returning a instance of <strong>JsonView</strong> as you can see in the following example</p>

<pre><code>
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {
  
    @Get
    public JsonView login(Request req, Response res){
        List<String> obj = Arrays.asList("item1", "item2", "item3");
        return new JsonView(obj);
    }
}
</code></pre>


<hr/>

<h3>
<a id="filters" class="anchor" href="#filters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Filters
</h3>

<p>Methods annotated with the <code class="java">@Before</code> annotation are executed before each action call for <code class="java">ServletIO</code>, and methods annotated with the <code class="java">@After</code> annotation are executed after each action call for the Servlet:</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result index(Request req){
        return respond("&#060;h1&#062;hello world&#060;/h1&#062;").as("text/html");
    }

    @Before
    public Result validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)
            respond("bye bye!!").asHtml();
            
        return null;
    }

    @After
    public Result log(Request req, Response res){
        System.out.println("Action executed...");
        
        return null;
    }

    @After
    public Result onNotFound(Request req){
        if(!isMapped(req))
            return notFound("&#060;h1&#062;404, not found&#060;/h1&#062;").as("text/html");

        return null;
    }

}
</code></pre>
<p>If you don’t want the <code class="java">@Before</code> or <code class="java">@After</code> methods to intercept all request, you can specify a list of actions using <code class="java">only</code> param:</p>
<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Get
    public Result login(Request req){
        return respond("&#060;h1&#062;login&#060;/h1&#062;").as("text/html");
    }

    @Before(only="/admin")
    public Result validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)  
            res.redirect("login");
        
        return null;
    }

    @After(only={"/login", "/logout"})
    public Result log(Request req, Response res){
        System.out.prinln("/login or /logout executed");
        
        return null;
    }

    @Get
    public JspView login(Request req, Response res){
        return new JspView("login.jsp");
    }
}
</code></pre>

<p>Or you can specify a list of actions to exclude for <code class="java">@After</code> or <code class="java">@Before</code> using the <code class="java">unless</code> param:</p>


<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Before(unless="/login")
    public JspView validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)
            return JspView("login");
            
        return null;
    }
    
    @Get
    public JspView login(Request req, Response res){
        return new JspView("login.jsp")
    }
}
</code></pre>

<p>You can set execution priority of <code class="java">@Before</code> or <code class="java">@After</code> methods using <code class="java">priority</code> param, example <code class="java">@Before(priority=1)</code>, by default priority is 0 (executed first):</p>

<pre><code class="java">
import javax.servlet.annotation.WebServlet;

import servletio.*;
import servletio.annotation.*;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    @Before(only="/admin/something", priority=2)
    public Result adminSomething(Request req, Response res){
        //some filter for this action
        
        return null;
    }

    @Before(only="/admin/*", priority=1)
    public Result validateUser(Request req, Response res){
        if(req.session().attribute("user")==null)
            res.redirect("login");
            
        return null;
    }
    
    @Get
    public JspView login(Request req, Response res){
        return new JspView("login");
    }
}
</code></pre>

<p>You may write a manual filter overriding "do" methods of the servlet as below:</p>
<pre>
  <code class="java">
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import servletio.*;
import servletio.annotation.Get;

@WebServlet("/base-path/*")
public class MyApp extends ServletIO {

    protected void doGet(HttpServletRequest req, HttpServletResponse res) {
        //filtering
        if(req.getSession(false).getAttribute("user")==null){
            //call method login as dispatcher
            getServletContext().getRequestDispatcher("login").forward(req, res);
        }
        
        super.doGet(request, response);
    }

    @Get
    public JspView login(Request req, Response res){
        new JspView("login");
    }
}
  </pre>
</code>

<hr>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
        </section>

        <footer>
          ServletIO is maintained by <a href="https://github.com/zerh">zerh</a><br>
          Tactile theme by Jason Long.
        </footer>

        
      </div>
    </div>
    <script>hljs.initHighlightingOnLoad();</script>
    <!-- Place this tag right after the last button or just before your close body tag. -->
    <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
  </body>
</html>
